{"version":3,"sources":["../../../../../src/js/app.js","../../../../../src/js/templates.js","../../../../../src/js/controllers/HeaderController.js","../../../../../src/js/controllers/HomeController.js","../../../../../src/js/controllers/ImageController.js","../../../../../src/js/controllers/LoginModalController.js","../../../../../src/js/controllers/UserController.js","../../../../../src/js/directives/paginator.js","../../../../../src/js/directives/stateBodyClass.js","../../../../../src/js/libraries/ArrayPrototype.js","../../../../../src/js/libraries/ImagePaster.js","../../../../../src/js/resources/AlbumResource.js","../../../../../src/js/resources/ImageResource.js","../../../../../src/js/resources/SessionResource.js","../../../../../src/js/resources/UserResource.js","../../../../../src/js/services/AuthService.js","../../../../../src/js/services/ImagePasterService.js"],"names":["app","angular","module","config","$httpProvider","$locationProvider","$stateProvider","$urlRouterProvider","localStorageServiceProvider","defaults","headers","common","RemoteUser","html5Mode","setPrefix","setStorageType","setStorageCookie","otherwise","state","url","templateUrl","controller","params","albumId","run","$rootScope","$state","AuthService","ImagePasterService","checkSession","user","getUser","$on","event","args","ev","to","toParams","from","fromParams","$","attr","name","$templateCache","put","$scope","ModalService","login","showModal","then","modal","close","result","message","logout","signup","alert","$timeout","title","subtitle","sprites","i","push","shuffle","join","mac","navigator","platform","test","$stateParams","$compile","ImageResource","AlbumResource","albumImages","image","imageId","editing","loading","init","loadAlbumImages","get","response","userId","username","moment","createdAt","format","fromNow","album","console","log","innerHTML","getImages","images","showTextDialog","showEmbedDialog","markdown","inputs","shareOnFb","encodeURIComponent","window","open","shareOnTwitter","annotate","cropCoords","cropping","savingCrop","jcrop","crop","Jcrop","onChange","c","saveCrop","scale","getImageScale","width","Math","round","w","height","h","x","y","exitCrop","data","destroy","css","rotate","rotating","revert","confirm","reverting","showPrivacyDialog","deleting","showReportDialog","parseInt","UserResource","loginData","password","errors","signupData","email","fb","forgot","messages","hasOwnProperty","general","save","page","go","currentPage","totalPages","getAlbums","albums","lastPage","directive","restrict","scope","link","elem","ctrl","toState","fromState","fromClassnames","isDefined","bodyClass","toClassnames","removeClass","addClass","Array","prototype","j","temp","this","length","floor","random","ImagePaster","debug","pasteCatcher","extra","self","document","createElement","setAttribute","id","body","appendChild","focus","addEventListener","onPaste","on","e","which","ctrlKey","metaKey","trigger","clipboardData","done","JSON","stringify","msConvertURL","fileList","files","uploadBlob","items","text","getData","uploadText","clearPasteCatcher","type","indexOf","getAsFile","setTimeout","checkPasteCatcher","child","childNodes","tagName","src","onFail","uploadImage","href","blob","reader","FileReader","onload","evt","target","readAsDataURL","upload","base64","ajax","timeout","error","jqXHR","textStatus","responseJSON","errorType","status","statusText","success","res","validateURL","regex","RegExp","factory","$resource","apiUrl","sessionKey","getSessionKey","cache","transformResponse","fromJson","isArray","method","action","degrees","session","service","localStorageService","SessionResource","$q","onLogin","onLogout","resolve","reject","newSession","newSessionKey","set","$broadcast","remove","viewUrl","imageUrl","find","getImageUploadUrl"],"mappings":"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","file":"ctrlv.min.js","sourcesContent":["\"use strict\";\n\n// Initialize angular\n\nvar app = angular.module('ctrlv', [\n    'ui.router',\n    'ngResource',\n    'ngSanitize',\n    'LocalStorageModule',\n    'angularModalService',\n    'ngAnimate'\n]);\n\n/**\n * Angular\n */\n\n// Routes\napp.config(function($httpProvider, $locationProvider, $stateProvider, $urlRouterProvider, localStorageServiceProvider) {\n\n     $httpProvider.defaults.headers.common = {\n        'RemoteUser': 'billybob'\n    };\n\n    $locationProvider.html5Mode(true);\n\n    localStorageServiceProvider\n        .setPrefix('ctrlv')\n        .setStorageType('localStorage')\n        .setStorageCookie(0, '/');\n\n    // For any unmatched url, redirect to /\n    $urlRouterProvider.otherwise('/');\n\n    // Now set up the states\n    $stateProvider\n        .state('home', {\n            url: \"/\",\n            templateUrl: \"views/home.html\",\n            controller: 'HomeController'\n        })\n        .state('help', {\n            url: \"/help\",\n            templateUrl: \"views/help.html\",\n            controller: 'HelpController'\n        })\n        .state('image', {\n            url: \"/{imageId:int}\",\n            templateUrl: \"views/image.html\",\n            controller: 'ImageController',\n            params: {\n                albumId: null\n            },\n        })\n        .state('user', {\n            url: \"/user/{username:string}\",\n            templateUrl: \"views/user.html\",\n            controller: 'UserController'\n        })\n        .state('user-page', {\n            url: \"/user/{username:string}/{page:int}\",\n            templateUrl: \"views/user.html\",\n            controller: 'UserController'\n        })\n        .state('user-favourites', {\n            url: \"/user/{username:string}/favourites\",\n            templateUrl: \"views/user/favourites.html\",\n            controller: 'UserFavouritesController'\n        });\n});\n\napp.run(function($rootScope, $state, AuthService, ImagePasterService) {\n    // ImagePasterService is injected here so it gets initialized\n\n\n    //$httpProvider.defaults.headers.post[\"Content-Type\"] = \"text/plain\";\n\n    $rootScope.$state = $state;\n\n\n    AuthService.checkSession();\n\n    $rootScope.user = AuthService.getUser();\n\n    $rootScope.$on('login', function(event, args) {\n        $rootScope.user = args.user;\n    });\n\n    $rootScope.$on('logout', function() {\n        $rootScope.user = false;\n    });\n\n    $rootScope.$on('$stateChangeSuccess', function (ev, to, toParams, from, fromParams) {\n        $('body').attr('data-previous', from.name);\n    });\n});\n\n","angular.module('ctrlv').run(['$templateCache', function($templateCache) {\n  'use strict';\n\n  $templateCache.put('views/home.html',\n    \"<div id=\\\"uploader\\\">\\n\" +\n    \"\\n\" +\n    \"    <div id=\\\"uploader-collage\\\" ng-bind-html=\\\"sprites\\\"></div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"upload-status\\\" id=\\\"upload-waiting\\\">\\n\" +\n    \"        <h2>The <span class=\\\"green\\\">easiest</span> way to share photos.</h2>\\n\" +\n    \"        <h3>\\n\" +\n    \"            <span style=\\\"float:right;\\\">\\n\" +\n    \"                You can also\\n\" +\n    \"                <a href=\\\"#\\\" class=\\\"btn\\\"><i class=\\\"typ typ-cloud-storage\\\"></i> Upload Images</a>\\n\" +\n    \"                or\\n\" +\n    \"                <a href=\\\"#\\\" class=\\\"btn\\\"><i class=\\\"typ typ-camera\\\"></i> Take a Photo</a>\\n\" +\n    \"            </span>\\n\" +\n    \"\\n\" +\n    \"            <i class=\\\"spinner-waiting\\\"></i>\\n\" +\n    \"            Press <span ng-if=\\\"mac\\\" class=\\\"btn btn-cmd\\\">cmd &#8984;</span><span ng-if=\\\"!mac\\\" class=\\\"btn btn-ctrl\\\">Ctrl</span>\\n\" +\n    \"            + <span class=\\\"btn btn-v\\\">V</span> to paste an image.\\n\" +\n    \"        </h3>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"upload-status out\\\" id=\\\"upload-loading\\\">\\n\" +\n    \"        <h3><i class=\\\"spinner-loading\\\"></i> Uploading...</h3>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"upload-status out\\\" id=\\\"upload-error\\\">\\n\" +\n    \"        <h3>Error</h3>\\n\" +\n    \"        <p></p>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"upload-status out\\\" id=\\\"upload-complete\\\">\\n\" +\n    \"        <h3>Uploaded!</h3>\\n\" +\n    \"        <p>\\n\" +\n    \"            <label>\\n\" +\n    \"                Here's your link\\n\" +\n    \"                <input type=\\\"text\\\" id=\\\"newImageURL\\\" class=\\\"green\\\" readonly=\\\"readonly\\\" />\\n\" +\n    \"            </label>\\n\" +\n    \"        </p>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"</div>\\n\"\n  );\n\n\n  $templateCache.put('views/image.html',\n    \"<div ng-if=\\\"image\\\" class=\\\"img-wrapper\\\">\\n\" +\n    \"\\n\" +\n    \"    <img\\n\" +\n    \"        ng-if=\\\"!loading && image\\\"\\n\" +\n    \"        ng-src=\\\"{{ image.image.url }}\\\"\\n\" +\n    \"        class=\\\"img\\\"\\n\" +\n    \"        id=\\\"img\\\"\\n\" +\n    \"        />\\n\" +\n    \"\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div\\n\" +\n    \"    ng-if=\\\"!loading && image\\\"\\n\" +\n    \"    class=\\\"sidebar img-left-sidebar\\\"\\n\" +\n    \"    ng-class=\\\"{\\n\" +\n    \"        'editable': user && user.userId === image.userId,\\n\" +\n    \"        'cropping': cropping,\\n\" +\n    \"        'revertable': image.hasOriginal\\n\" +\n    \"    }\\\"\\n\" +\n    \"    >\\n\" +\n    \"\\n\" +\n    \"    <div ng-if=\\\"cropping\\\">\\n\" +\n    \"        <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"saveCrop()\\\"><i class=\\\"typ typ-scissors\\\" ng-hide=\\\"savingCrop\\\"></i><i class=\\\"spinner-loading dark\\\" ng-show=\\\"savingCrop\\\"></i><span>Save Crop</span></a>\\n\" +\n    \"        <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"exitCrop()\\\"><i class=\\\"typ typ-times\\\"></i><span>Cancel</span></a>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div ng-hide=\\\"cropping\\\">\\n\" +\n    \"        <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"showTextDialog()\\\"><i class=\\\"typ typ-sort-alphabetically\\\"></i><span>Text Recognition</span></a>\\n\" +\n    \"        <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"showEmbedDialog()\\\"><i class=\\\"typ typ-code\\\"></i><span>Embed</span></a>\\n\" +\n    \"        <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"shareOnFb()\\\"><i class=\\\"typ typ-social-facebook\\\"></i><span>Share</span></a>\\n\" +\n    \"        <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"shareOnTwitter()\\\"><i class=\\\"typ typ-social-twitter\\\"></i><span>Tweet</span></a>\\n\" +\n    \"\\n\" +\n    \"        <hr/>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"user && user.userId === image.userId\\\">\\n\" +\n    \"            <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"annotate()\\\"><i class=\\\"typ typ-brush\\\"></i><span>Annotate</span></a>\\n\" +\n    \"            <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"crop()\\\"><i class=\\\"typ typ-scissors-outline\\\"></i><span>Crop</span></a>\\n\" +\n    \"            <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"rotate()\\\"><i class=\\\"typ typ-arrow-sync-outline\\\" ng-hide=\\\"rotating\\\"></i><i class=\\\"spinner-loading dark\\\" ng-show=\\\"rotating\\\"></i><span>Rotate</span></a>\\n\" +\n    \"            <a class=\\\"btn\\\" href=\\\"#\\\" ng-if=\\\"image.hasOriginal\\\" ng-click=\\\"revert()\\\"><i class=\\\"typ typ-arrow-back\\\" ng-hide=\\\"reverting\\\"></i><i class=\\\"spinner-loading dark\\\" ng-show=\\\"reverting\\\"></i><span>Revert To Original</span></a>\\n\" +\n    \"            <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"showPrivacyDialog()\\\"><i class=\\\"typ typ-lock-closed\\\"></i><span>Privacy</span></a>\\n\" +\n    \"            <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"delete()\\\"><i class=\\\"typ typ-trash\\\" ng-hide=\\\"deleting\\\"></i><i class=\\\"spinner-loading dark\\\" ng-show=\\\"deleting\\\"></i><span>Delete</span></a>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"!user || user.userId !== image.userId\\\">\\n\" +\n    \"            <a class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"showReportDialog()\\\"><i class=\\\"typ typ-flag\\\"></i><span>Report</span></a>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"sidebar img-right-sidebar\\\" ng-if=\\\"albumImages.length > 0\\\">\\n\" +\n    \"    <ul>\\n\" +\n    \"        <li>In This Album</li>\\n\" +\n    \"        <li ng-repeat=\\\"albumImage in albumImages\\\" ng-class=\\\"{active: imageId == albumImage.imageId}\\\">\\n\" +\n    \"            <a ui-sref=\\\"image({ imageId: albumImage.imageId, albumId: albumId })\\\"><img ng-src=\\\"{{ albumImage.thumbnail.url }}\\\" /></a>\\n\" +\n    \"        </li>\\n\" +\n    \"    </ul>\\n\" +\n    \"</div>\\n\"\n  );\n\n\n  $templateCache.put('views/modals/image-embed.html',\n    \"<div class=\\\"modal\\\" ng-click=\\\"close()\\\" id=\\\"image-embed-modal\\\">\\n\" +\n    \"    <div class=\\\"modal-content\\\" ng-click=\\\"$event.stopPropagation()\\\">\\n\" +\n    \"\\n\" +\n    \"        <h2><i class=\\\"typ typ-export\\\"></i>Link To <small>this image.</small></h2>\\n\" +\n    \"\\n\" +\n    \"        <div class=\\\"container-fluid\\\">\\n\" +\n    \"            <div class=\\\"row\\\">\\n\" +\n    \"                <div class=\\\"col-sm-6\\\">\\n\" +\n    \"\\n\" +\n    \"                    <div class=\\\"form-group\\\">\\n\" +\n    \"                        <h4>Markdown Link <small>e.g. for Reddit comments</small></h4>\\n\" +\n    \"                        <textarea rows=\\\"2\\\" class=\\\"form-control\\\" readonly=\\\"readonly\\\">[{{image.url}}]({{image.url}}</textarea>\\n\" +\n    \"                    </div>\\n\" +\n    \"\\n\" +\n    \"                    <div class=\\\"form-group\\\">\\n\" +\n    \"                        <p><small><a href=\\\"http://redditenhancementsuite.com/\\\">Reddit Enhancement Suite</a> supports CtrlV, so you can also just use this link in Reddit comments:</small></p>\\n\" +\n    \"                        <input type=\\\"text\\\" class=\\\"form-control\\\" readonly=\\\"readonly\\\" value=\\\"{{image.url}}\\\" />\\n\" +\n    \"                    </div>\\n\" +\n    \"\\n\" +\n    \"                    <div class=\\\"form-group\\\">\\n\" +\n    \"                        <h4>Markdown Image <small>e.g. for GitHub/BitBucket READMEs</small></h4>\\n\" +\n    \"                        <textarea rows=\\\"3\\\" class=\\\"form-control\\\" readonly=\\\"readonly\\\">[![{{ image.title }}]({{image.image.url}})]({{image.url}})</textarea>\\n\" +\n    \"                    </div>\\n\" +\n    \"\\n\" +\n    \"                </div>\\n\" +\n    \"                <div class=\\\"col-sm-6\\\">\\n\" +\n    \"\\n\" +\n    \"                    <div class=\\\"form-group\\\">\\n\" +\n    \"                        <h4>BBCode <small>for forums</small></h4>\\n\" +\n    \"                        <textarea rows=\\\"3\\\" class=\\\"form-control\\\" readonly=\\\"readonly\\\">[url={{image.url}}][img]{{image.image.url}}[/img]{{image.title}}[/url]</textarea>\\n\" +\n    \"                    </div>\\n\" +\n    \"\\n\" +\n    \"                    <div class=\\\"form-group\\\">\\n\" +\n    \"                        <h4>HTML <small>for websites</small></h4>\\n\" +\n    \"                        <textarea rows=\\\"5\\\" class=\\\"form-control\\\" readonly=\\\"readonly\\\">&lt;a href=&quot;{{image.url}}&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;{{image.image.url}}&quot; style=&quot;max-width:900px;&quot; alt=&quot;CtrlV.in Image Hosting&quot; /&gt;&lt;/a&gt;</textarea>\\n\" +\n    \"                    </div>\\n\" +\n    \"\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\"\n  );\n\n\n  $templateCache.put('views/modals/login.html',\n    \"<div class=\\\"modal\\\" ng-click=\\\"close()\\\">\\n\" +\n    \"    <div class=\\\"modal-content\\\" ng-click=\\\"$event.stopPropagation()\\\">\\n\" +\n    \"\\n\" +\n    \"        <div class=\\\"container-fluid\\\">\\n\" +\n    \"            <div class=\\\"row\\\">\\n\" +\n    \"                <div class=\\\"col-sm-6\\\">\\n\" +\n    \"                    <form ng-submit=\\\"login()\\\">\\n\" +\n    \"                        <h2>Login <small>to you CtrlV account.</small></h2>\\n\" +\n    \"\\n\" +\n    \"                        <div class=\\\"form-group\\\" ng-class=\\\"{'has-error': loginData.errors.username}\\\">\\n\" +\n    \"                            <label class=\\\"control-label\\\"><i class=\\\"typ typ-user\\\"></i> Username\\n\" +\n    \"                                <input class=\\\"form-control\\\" type=\\\"text\\\" ng-model=\\\"loginData.username\\\" name=\\\"username\\\" />\\n\" +\n    \"                            </label>\\n\" +\n    \"\\n\" +\n    \"                            <span ng-if=\\\"loginData.errors.username\\\" class=\\\"help-block\\\">{{ loginData.errors.username.join(' ') }}</span>\\n\" +\n    \"\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <div class=\\\"form-group\\\" ng-class=\\\"{'has-error': loginData.errors.password}\\\">\\n\" +\n    \"                            <label class=\\\"control-label\\\"><i class=\\\"typ typ-key\\\"></i> Password\\n\" +\n    \"                                <input class=\\\"form-control\\\" type=\\\"password\\\" ng-model=\\\"loginData.password\\\" name=\\\"password\\\" />\\n\" +\n    \"                            </label>\\n\" +\n    \"\\n\" +\n    \"                            <span ng-if=\\\"loginData.errors.password\\\" class=\\\"help-block\\\">{{ loginData.errors.password.join(' ') }}</span>\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <div class=\\\"form-group\\\">\\n\" +\n    \"                            <label>\\n\" +\n    \"                                <a href=\\\"#\\\" ng-click=\\\"forgot()\\\"><i class=\\\"typ typ-warning-outline\\\"></i> Forgot you password?</a>\\n\" +\n    \"                            </label>\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <div class=\\\"form-group\\\">\\n\" +\n    \"                            <label>\\n\" +\n    \"                                <a href=\\\"#\\\" ng-click=\\\"fb()\\\"><i class=\\\"typ typ-social-facebook\\\"></i> Used to login with Facebook?</a>\\n\" +\n    \"                            </label>\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <div ng-if=\\\"loginData.errors.general\\\" class=\\\"form-group has-error\\\">\\n\" +\n    \"                            <span class=\\\"help-block\\\"><i class=\\\"typ typ-warning\\\"></i> {{ loginData.errors.general }}</span>\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <button class=\\\"btn btn-block\\\">\\n\" +\n    \"                            <i class=\\\"spinner-loading dark\\\" ng-show=\\\"loginData.loading\\\"></i>\\n\" +\n    \"                            <span ng-hide=\\\"loginData.loading\\\">Login</span>\\n\" +\n    \"                        </button>\\n\" +\n    \"                    </form>\\n\" +\n    \"                </div>\\n\" +\n    \"\\n\" +\n    \"                <div class=\\\"col-sm-6\\\">\\n\" +\n    \"                    <form ng-submit=\\\"signup()\\\">\\n\" +\n    \"                        <h2>Create <small>a new CtrlV account.</small></h2>\\n\" +\n    \"\\n\" +\n    \"                        <div class=\\\"form-group\\\" ng-class=\\\"{'has-error': signupData.errors.username}\\\">\\n\" +\n    \"                            <label class=\\\"control-label\\\"><i class=\\\"typ typ-user\\\"></i> Username\\n\" +\n    \"                                <input class=\\\"form-control\\\" type=\\\"text\\\" ng-model=\\\"signupData.username\\\" name=\\\"username\\\" />\\n\" +\n    \"                            </label>\\n\" +\n    \"\\n\" +\n    \"                            <span ng-if=\\\"signupData.errors.username\\\" class=\\\"help-block\\\">{{ signupData.errors.username.join(' ') }}</span>\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <div class=\\\"form-group\\\" ng-class=\\\"{'has-error': signupData.errors.username}\\\">\\n\" +\n    \"                            <label class=\\\"control-label\\\"><i class=\\\"typ typ-key\\\"></i> Password\\n\" +\n    \"                                <input class=\\\"form-control\\\" type=\\\"password\\\" ng-model=\\\"signupData.password\\\" name=\\\"password\\\" />\\n\" +\n    \"                            </label>\\n\" +\n    \"\\n\" +\n    \"                            <span ng-if=\\\"signupData.errors.password\\\" class=\\\"help-block\\\">{{ signupData.errors.password.join(' ') }}</span>\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <div class=\\\"form-group\\\" ng-class=\\\"{'has-error': signupData.errors.email}\\\">\\n\" +\n    \"                            <label class=\\\"control-label\\\"><i class=\\\"typ typ-mail\\\"></i> Email Address\\n\" +\n    \"                                <input class=\\\"form-control\\\" type=\\\"email\\\" ng-model=\\\"signupData.email\\\" name=\\\"email\\\" />\\n\" +\n    \"                            </label>\\n\" +\n    \"\\n\" +\n    \"                            <span ng-if=\\\"signupData.errors.email\\\" class=\\\"help-block\\\">{{ signupData.errors.email.join(' ') }}</span>\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <div ng-if=\\\"signupData.errors.general\\\" class=\\\"form-group has-error\\\">\\n\" +\n    \"                            <span class=\\\"help-block\\\"><i class=\\\"typ typ-warning\\\"></i> {{ signupData.errors.general }}</span>\\n\" +\n    \"                        </div>\\n\" +\n    \"\\n\" +\n    \"                        <button class=\\\"btn btn-block\\\">\\n\" +\n    \"                            <i class=\\\"spinner-loading dark\\\" ng-show=\\\"signupData.loading\\\"></i>\\n\" +\n    \"                            <span ng-hide=\\\"signupData.loading\\\">Signup</span>\\n\" +\n    \"                        </button>\\n\" +\n    \"                    </form>\\n\" +\n    \"                </div>\\n\" +\n    \"\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\"\n  );\n\n\n  $templateCache.put('views/partials/footer.html',\n    \"<footer>\\n\" +\n    \"\\n\" +\n    \"    <!--<div style=\\\"float:left;\\\">\\n\" +\n    \"        View:\\n\" +\n    \"        <a class=\\\"btn\\\" href=\\\"#\\\">Grid (Classic)</a>\\n\" +\n    \"        <a class=\\\"btn\\\" href=\\\"#\\\">Columns</a>\\n\" +\n    \"    </div>-->\\n\" +\n    \"\\n\" +\n    \"    <ul class=\\\"links\\\">\\n\" +\n    \"        <li>Created by <a href=\\\"https://themediadudes.com\\\">The Media Dudes</a></li>\\n\" +\n    \"        <li><a href=\\\"https://api.ctrlv.in/docs\\\"><i class=\\\"typ typ-flow-switch\\\"></i> API</a></li>\\n\" +\n    \"        <li><a href=\\\"mailto:help@ctrlv.in\\\"><i class=\\\"typ typ-mail\\\"></i> Contact Us</a></li>\\n\" +\n    \"        <li><a href=\\\"https://github.com/antriver/ctrlv-frontend\\\"><i class=\\\"typ typ-social-github\\\"></i> GitHub</a></li>\\n\" +\n    \"        <li><a ui-sref=\\\"help\\\"><i class=\\\"typ typ-info-large-outline\\\"></i> Help</a></li>\\n\" +\n    \"        <li><a ui-sref=\\\"privacy\\\"><i class=\\\"typ typ-lock-closed-outline\\\"></i> Privacy</a></li>\\n\" +\n    \"        <li><a ui-sref=\\\"terms\\\"><i class=\\\"typ typ-sort-alphabetically-outline\\\"></i> Terms of Use</a></li>\\n\" +\n    \"    </ul>\\n\" +\n    \"</footer>\\n\"\n  );\n\n\n  $templateCache.put('views/partials/header.html',\n    \"<header class=\\\"clearfix\\\">\\n\" +\n    \"    <a ui-sref=\\\"home\\\" id=\\\"logo-container\\\">\\n\" +\n    \"        <img src=\\\"/assets/img/ctrlv.svg\\\" id=\\\"logo\\\" />\\n\" +\n    \"    </a>\\n\" +\n    \"\\n\" +\n    \"    <h1 id=\\\"page-title\\\" ng-bind-html=\\\"title\\\" ng-class=\\\"{'with-subtitle': subtitle}\\\"></h1>\\n\" +\n    \"    <h3 id=\\\"page-subtitle\\\" ng-bind-html=\\\"subtitle\\\"></h3>\\n\" +\n    \"\\n\" +\n    \"    <div  id=\\\"current-user\\\">\\n\" +\n    \"        <div ng-if=\\\"user === false\\\">\\n\" +\n    \"            <a id=\\\"login-btn\\\" class=\\\"btn\\\" href=\\\"#\\\" ng-click=\\\"login()\\\"><i class=\\\"typ typ-user\\\"></i> Login or Signup</a>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"user\\\">\\n\" +\n    \"            <h2>Hi <a ui-sref=\\\"user({ username: user.username.toLowerCase() })\\\" ng-bind=\\\"user.username\\\"></a></h2>\\n\" +\n    \"            <ul class=\\\"links\\\">\\n\" +\n    \"                <li><a ui-sref=\\\"user-favourites({ username: user.username.toLowerCase() })\\\"><i class=\\\"typ typ-heart-full-outline\\\"></i> Favourites</a></li>\\n\" +\n    \"                <li><a ui-sref=\\\"settings\\\"><i class=\\\"typ typ-spanner\\\"></i> Options</a></li>\\n\" +\n    \"                <li><a href=\\\"#\\\" ng-click=\\\"logout()\\\"><i class=\\\"typ typ-lock-open\\\"></i> Logout</a></li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</header>\\n\"\n  );\n\n\n  $templateCache.put('views/partials/image-list.html',\n    \"<ul ng-if=\\\"images.length > 0\\\" class=\\\"img-grid\\\">\\n\" +\n    \"    <li ng-repeat=\\\"image in images\\\">\\n\" +\n    \"        <a\\n\" +\n    \"            ui-sref=\\\"image({ imageId: image.imageId })\\\"\\n\" +\n    \"            ng-style=\\\"{'background-image': image.thumbnail ? '' : 'url('+ image.image.url + ')'}\\\"\\n\" +\n    \"            >\\n\" +\n    \"            <img ng-if=\\\"image.thumbnail\\\" class=\\\"img-thumb\\\" ng-src=\\\"{{ image.thumbnail.url }}\\\" />\\n\" +\n    \"        </a>\\n\" +\n    \"    </li>\\n\" +\n    \"</ul>\\n\" +\n    \"\\n\" +\n    \"{{ currentPage }} / {{ totalPages }}\\n\" +\n    \"\\n\" +\n    \"<paginator total-pages=\\\"totalPages\\\" current-page=\\\"currentPage\\\"></paginator>\\n\"\n  );\n\n\n  $templateCache.put('views/partials/paginator.html',\n    \"<ul class=\\\"sidebar paginator\\\">\\n\" +\n    \"{{ currentPage }} / {{ totalPages }}\\n\" +\n    \"    <li><a href=\\\"#\\\" ng-bind=\\\"page\\\">{{ currentPage }}</a></li>\\n\" +\n    \"    <li><a href=\\\"2\\\">2</a></li>\\n\" +\n    \"    <li><a href=\\\"3\\\">3</a></li>\\n\" +\n    \"    <li><a href=\\\"4\\\">4</a></li>\\n\" +\n    \"    <li><a href=\\\"5\\\">5</a></li>\\n\" +\n    \"</ul>\\n\"\n  );\n\n\n  $templateCache.put('views/user.html',\n    \"<ng-include src=\\\"'views/partials/image-list.html'\\\"></ng-include>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"album-sidebar\\\" ng-if=\\\"albums.length > 0\\\">\\n\" +\n    \"    <ul>\\n\" +\n    \"        <li>Albums</li>\\n\" +\n    \"        <li ng-repeat=\\\"album in albums\\\" ng-class=\\\"{active: albumId == albums.albumId}\\\">\\n\" +\n    \"            <a ui-sref=\\\"image({ imageId: albumImage.imageId, albumId: albumId })\\\">{{ album.title }}</a>\\n\" +\n    \"        </li>\\n\" +\n    \"    </ul>\\n\" +\n    \"</div>\\n\"\n  );\n\n}]);\n","app.controller(\n    'HeaderController',\n    function ($scope, $rootScope, ModalService, AuthService) {\n\n        $scope.login = function() {\n            // Just provide a template url, a controller and call 'showModal'.\n            ModalService.showModal({\n                templateUrl: 'views/modals/login.html',\n                controller: 'LoginModalController'\n            }).then(function(modal) {\n                // The modal object has the element built, if this is a bootstrap modal\n                // you can call 'modal' to show it, if it's a custom modal just show or hide\n                // it as you need to.\n                //modal.element.modal();\n                modal.close.then(function(result) {\n                    $scope.message = result ? \"You said Yes\" : \"You said No\";\n                });\n            });\n        };\n\n        $scope.logout = function() {\n            AuthService.logout();\n        };\n\n        $scope.signup = function() {\n            alert('signup');\n        };\n\n    }\n);\n","app.controller(\n    'HomeController',\n    function ($scope, $rootScope, $timeout) {\n\n        $rootScope.title = '';\n        $rootScope.subtitle = '';\n\n        var sprites = [];\n        for (var i = 0; i < 20; i++) {\n            sprites.push('<span class=\"homesprite homesprite-' + i + '\"></span>');\n        }\n        sprites.shuffle();\n        $scope.sprites = sprites.join('');\n\n        $scope.mac = navigator.platform === \"MacIntel\";\n\n        $timeout(function() {\n            $scope.test = true;\n        }, 1000);\n    }\n);\n","app.controller(\n    'ImageController',\n    function ($scope, $rootScope, $state, $stateParams, $compile, AuthService, ImageResource, AlbumResource, ModalService) {\n\n        $scope.albumId = null;\n        $scope.albumImages = [];\n        $scope.image = null;\n        $scope.imageId = $stateParams.imageId;\n        $scope.editing = false;\n\n        $rootScope.loading = true;\n        $rootScope.title = '';\n        $rootScope.subtitle = '';\n\n        $scope.init = function () {\n\n            if ($stateParams.albumId) {\n                $scope.loadAlbumImages($stateParams.albumId);\n            }\n\n            ImageResource.get({imageId: $stateParams.imageId}, function (response) {\n                $scope.image = response.image;\n                $rootScope.loading = false;\n\n                // TODO: If the image is passworded show login prompt\n                // Show errors\n                // If anon or passworded, refresh on logout\n\n                var title = '';\n                if ($scope.image.title) {\n                    title = $scope.image.title;\n                } else {\n                    title = 'Image #' + $scope.image.imageId;\n                }\n                $rootScope.title = title;\n\n                var subtitle = '<span>';\n                if ($scope.image.userId) {\n                    subtitle += '<i class=\"typ typ-user\"></i> By <a ui-sref=\"user({username: image.user.username.toLowerCase()})\">' + $scope.image.user.username + '</a>';\n                }\n                subtitle += '<i class=\"typ typ-time\"></i> <span title=\"' + moment($scope.image.createdAt).format(\"dddd, MMMM Do YYYY, h:mm:ss a\") + '\">' + moment($scope.image.createdAt).fromNow() + '</span>';\n\n                if ($scope.image.album) {\n                    subtitle += '<i class=\"typ typ-folder-open\"></i> In <a ui-sref=\"album({albumId: image.album.albumId})\">' + $scope.image.album.title + '</a>';\n                }\n                subtitle += '</span>';\n\n                console.log($compile(subtitle)($scope));\n                $rootScope.subtitle = $compile(subtitle)($scope)[0].innerHTML;\n\n                if ($scope.image.albumId && $scope.image.albumId !== $scope.albumId) {\n                    $scope.loadAlbumImages($scope.image.albumId);\n                }\n            });\n        };\n\n        $scope.loadAlbumImages = function (albumId) {\n            $scope.albumId = albumId;\n            // Get the images in the album to show on the left\n            AlbumResource.getImages({albumId: albumId}, function (images) {\n                $scope.albumImages = images;\n            });\n        };\n\n        /**\n         * Sidebar Buttons\n         */\n\n        $scope.showTextDialog = function () {\n\n        };\n\n        $scope.showEmbedDialog = function () {\n            ModalService.showModal({\n                templateUrl: 'views/modals/image-embed.html',\n                controller: function ($scope, close, image) {\n                    $scope.image = image;\n\n                    $scope.markdown = '[![' + image.title + '](' + image.image.url + ')](' + image.url + ')';\n\n                    $scope.close = close;\n                },\n                inputs: {\n                    image: $scope.image\n                }\n            });\n        };\n\n        $scope.shareOnFb = function () {\n            var url = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent($scope.image.url);\n            window.open(url);\n        };\n\n        $scope.shareOnTwitter = function () {\n            var url = 'https://twitter.com/home?status=' + encodeURIComponent($scope.image.url);\n            window.open(url);\n        };\n\n        $scope.annotate = function () {\n\n        };\n\n        $scope.cropCoords = null;\n        $scope.cropping = false;\n        $scope.savingCrop = false;\n        $scope.jcrop = null;\n\n        $scope.crop = function () {\n            if ($scope.editing) {\n                return false;\n            }\n            $scope.cropping = true;\n            $scope.jcrop = $.Jcrop('#img', {\n                onChange: function (c) {\n                    console.log(c);\n                    $scope.cropCoords = c;\n                }\n            });\n        };\n\n        $scope.saveCrop = function () {\n\n            // How much is the image scaled on screen\n            var scale = $scope.getImageScale();\n\n            var params = {\n                imageId: $scope.imageId,\n                width: Math.round($scope.cropCoords.w / scale),\n                height: Math.round($scope.cropCoords.h / scale),\n                x: Math.round($scope.cropCoords.x / scale),\n                y: Math.round($scope.cropCoords.y / scale),\n            };\n            $scope.savingCrop = true;\n            ImageResource.crop(\n                params,\n                function(response) {\n                    $scope.exitCrop();\n                    $scope.image = response.image;\n                },\n                function(response) {\n                    $scope.savingCrop = false;\n                    alert(response.data.message);\n                }\n            );\n        };\n\n        $scope.exitCrop = function () {\n            $scope.jcrop.destroy();\n            $scope.cropCoords = null;\n            $scope.cropping = false;\n            $scope.jcrop = null;\n            $scope.savingCrop = false;\n            // Undo what jcrop did\n            $('#img').css({width:'', height:''});\n        };\n\n        $scope.rotate = function () {\n            if ($scope.editing) {\n                return false;\n            }\n            $scope.editing = true;\n            $scope.rotating = true;\n            ImageResource.rotate(\n                {\n                    imageId: $scope.image.imageId\n                },\n                function (response) {\n                    $scope.editing = false;\n                    $scope.rotating = false;\n                    $scope.image = response.image;\n                },\n                function (response) {\n                    $scope.editing = false;\n                    $scope.rotating = false;\n                    alert(response.data.message);\n                }\n            );\n        };\n\n        $scope.revert = function () {\n            if ($scope.editing) {\n                return false;\n            }\n\n            if (!confirm(\"This will undo and cropping and remove any annotation. Are you sure you want to do this?\")) {\n                return false;\n            }\n\n            $scope.editing = true;\n            $scope.reverting = true;\n            ImageResource.revert(\n                {\n                    imageId: $scope.image.imageId\n                },\n                function (response) {\n                    $scope.editing = false;\n                    $scope.reverting = false;\n                    $scope.image = response.image;\n                },\n                function (response) {\n                    $scope.editing = false;\n                    $scope.reverting = false;\n                    alert(response.data.message);\n                }\n            );\n        };\n\n        $scope.showPrivacyDialog = function () {\n\n        };\n\n        $scope.delete = function () {\n            if ($scope.editing) {\n                return false;\n            }\n\n            if (!confirm(\"Are you sure you want to delete this image?\")) {\n                return false;\n            }\n\n            $scope.editing = true;\n            $scope.deleting = true;\n            ImageResource.delete(\n                {\n                    imageId: $scope.image.imageId\n                },\n                function () {\n                    $scope.editing = false;\n                    $scope.deleting = false;\n                    $scope.image = null;\n                },\n                function (response) {\n                    $scope.editing = false;\n                    $scope.deleting = false;\n                    alert(response.data.message);\n                }\n            );\n        };\n\n        $scope.showReportDialog = function () {\n\n        };\n\n        /**\n         * Returns how much the image is scaled to fit on the screen.\n         */\n        $scope.getImageScale = function () {\n            return parseInt($('#img').width()) / $scope.image.image.width;\n        };\n\n        $scope.init();\n    }\n);\n","app.controller(\n    'LoginModalController',\n    function ($scope, close, AuthService, UserResource) {\n\n        $scope.loginData = {\n            loading: false,\n            username: '',\n            password: '',\n            errors: {}\n        };\n\n        $scope.signupData = {\n            loading: false,\n            username: '',\n            password: '',\n            email: '',\n            errors: {}\n        };\n\n        $scope.fb = function () {\n            alert(':(');\n        };\n\n        $scope.forgot = function () {\n            alert('lol');\n        };\n\n        $scope.login = function () {\n            if ($scope.loginData.loading) {\n                return false;\n            }\n            $scope.loginData.errors = {};\n            $scope.loginData.loading = true;\n\n            AuthService\n                .login($scope.loginData.username, $scope.loginData.password)\n                .then(\n                    function (response) {\n                        $scope.loginData.loading = false;\n\n                        close();\n                    },\n                    function (response) {\n                        $scope.loginData.loading = false;\n\n                        if (\n                            response.messages\n                            &&\n                            (\n                                response.messages.hasOwnProperty('username')\n                                ||\n                                response.messages.hasOwnProperty('password')\n                            )\n                        ) {\n                            $scope.loginData.errors = response.messages;\n                        } else {\n\n                            $scope.loginData.errors = {\n                                general: response.message\n                            };\n                        }\n\n                    }\n                );\n        };\n\n\n        $scope.signup = function () {\n            if ($scope.signupData.loading) {\n                return false;\n            }\n            $scope.signupData.errors = {};\n            $scope.signupData.loading = true;\n\n            UserResource.save({\n                username: $scope.signupData.username,\n                password: $scope.signupData.password,\n                email: $scope.signupData.email,\n            }, function(response) {\n\n                AuthService\n                    .login($scope.signupData.username, $scope.signupData.password)\n                    .then(\n                        function (response) {\n                            $scope.signupData.loading = false;\n                            close();\n                        },\n                        function (response) {\n                            $scope.signupData.loading = false;\n                            $scope.signupData.errors = {\n                                general: response.message\n                            };\n                        }\n                    );\n\n            }, function (response) {\n                $scope.signupData.loading = false;\n\n                response = response.data;\n                if (\n                    response.messages\n                    &&\n                    (\n                        response.messages.hasOwnProperty('username')\n                        ||\n                        response.messages.hasOwnProperty('password')\n                        ||\n                        response.messages.hasOwnProperty('email')\n                    )\n                ) {\n                    $scope.signupData.errors = response.messages;\n                } else {\n\n                    $scope.signupData.errors = {\n                        general: response.message\n                    };\n                }\n            });\n        };\n\n        $scope.close = close;\n\n    }\n);\n","app.controller(\n    'UserController',\n    function ($scope, $rootScope, $state, $stateParams, AuthService, UserResource) {\n\n        $scope.images = [];\n        $rootScope.loading = true;\n        $scope.username = $stateParams.username;\n\n        if ($stateParams.page === 1) {\n            $state.go('user', {username: $scope.username});\n            return;\n        }\n\n        $scope.currentPage = $stateParams.page ? $stateParams.page : 1;\n        $scope.totalPages = 0;\n\n        $rootScope.title = '';\n        $rootScope.subtitle = '';\n\n        UserResource.get({username: $scope.username}, function(user) {\n            $rootScope.title = '<i class=\"typ typ-image\"></i> ' + user.username + \"'s Images\";\n\n            // FIXME: happens too fast when loading directly on /user/username page\n            if ($rootScope.user && $rootScope.user.userId === user.userId) {\n                UserResource.getAlbums({username: $scope.username}, function (albums) {\n                    $scope.albums = albums;\n                });\n            }\n        });\n\n        UserResource.getImages({username: $scope.username, page: $scope.currentPage}, function(data) {\n            $rootScope.loading = false;\n            $scope.images = data.images;\n            $scope.totalPages = data.lastPage;\n            console.log(data);\n        });\n    }\n);\n","app.directive('paginator', function factory() {\n    return {\n        restrict: 'E',\n        controller: function ($scope) {\n            console.log('$scope', $scope);\n        },\n        scope: {\n            currentPage: '=',\n            totalPages: '='\n        },\n        templateUrl: 'views/partials/paginator.html'\n    };\n});\n","/**\n * Source: http://stackoverflow.com/a/32574746/710630\n */\n(function () {\n    'use strict';\n\n    app.directive(\n        'stateBodyClass',\n        function ($rootScope) {\n            return {\n                restrict: 'A',\n                scope: {},\n                link: function (scope, elem, attr, ctrl) {\n\n                    $rootScope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {\n                        var fromClassnames = angular.isDefined(fromState.data) && angular.isDefined(fromState.data.bodyClass) ? fromState.data.bodyClass : null;\n                        var toClassnames = angular.isDefined(toState.data) && angular.isDefined(toState.data.bodyClass) ? toState.data.bodyClass : null;\n\n                        // don't do anything if they are the same\n                        if (fromClassnames != toClassnames) {\n                            if (fromClassnames) {\n                                elem.removeClass(fromClassnames);\n                            }\n\n                            if (toClassnames) {\n                                elem.addClass(toClassnames);\n                            }\n                        }\n                    });\n                }\n            };\n        }\n    );\n\n}());\n","/**\n * Shuffles the items in an array.\n * Source: http://stackoverflow.com/a/10142256/710630\n *\n * @returns {Array}\n */\nArray.prototype.shuffle = function() {\n    var i = this.length, j, temp;\n    if (i === 0) {\n        return this;\n    }\n    while (--i) {\n        j = Math.floor( Math.random() * ( i + 1 ) );\n        temp = this[i];\n        this[i] = this[j];\n        this[j] = temp;\n    }\n    return this;\n};\n","var ImagePaster = (function () {\n    \"use strict\";\n\n    var ImagePaster = function (url) {\n        console.log('ImagePaster', url);\n        this.debug = true;\n        this.url = url;\n        this.pasteCatcher = null;\n        this.init();\n    };\n\n    ImagePaster.prototype.log = function (data, extra) {\n        if (this.debug) {\n            console.log(data, extra);\n        }\n    };\n\n    ImagePaster.prototype.init = function () {\n\n        var self = this;\n\n        /**\n         * Firefox allows images to be pasted into contenteditable elements.\n         * So create one of those on the page and make it have focus,\n         * so paste events happen into that\n         */\n\n        // Create paste catcher element\n        self.pasteCatcher = document.createElement('div');\n        self.pasteCatcher.setAttribute('contenteditable', '');\n        self.pasteCatcher.setAttribute('style', 'position:absolute; opacity:0; top:0; left:0; width:0; height:0;');\n        self.pasteCatcher.id = 'paste-catcher';\n        document.body.appendChild(self.pasteCatcher);\n        self.pasteCatcher.focus();\n\n        // Listen for the 'paste' event on the body\n        //if (browserName == 'IE') {\n        //$('body').on('paste', function(event) { self.onPaste(event); });\n        //} else {\n        document.addEventListener('paste', function (event) {\n            self.onPaste(event);\n        });\n        //}\n\n        // Watch for ctrl + v being pressed\n        $(document).on('keydown', function (e) {\n            // 86 = v\n            if (e.which === 86 && (e.ctrlKey || e.metaKey)) {\n                $(document).trigger('ctrlVPressed');\n            }\n        });\n\n        // Focus paste catcher when cmd or ctrlv is pressed\n        $(document).on('ctrlVPressed', function () {\n            self.pasteCatcher.focus();\n        });\n\n    };\n\n    ImagePaster.prototype.onPaste = function (event) {\n\n        var self = this;\n        var done = false;\n        var clipboardData;\n\n        self.log('onPaste', JSON.stringify(event));\n\n        if (event.clipboardData) {\n            // Chrome\n            clipboardData = event.clipboardData;\n        } else if (window.clipboardData) {\n            // IE\n            clipboardData = window.clipboardData;\n        } else {\n            // Firefox\n            //setTimeout(this.checkPasteCatcher, 1);\n        }\n\n        // IE\n        if (event.msConvertURL) {\n            var fileList = clipboardData.files;\n            if (fileList.length > 0) {\n                for (var i = 0; i < fileList.length; i++) {\n                    self.uploadBlob(fileList[i]);\n                    done = true;\n                }\n            }\n        }\n\n        // Check if there is something in the paste event itself\n        if (clipboardData && clipboardData.items) {\n\n            var text;\n            // If there was some text on the clipboard,\n            // it might be a URL. Try and paste that...\n            if ((text = clipboardData.getData(\"text/plain\"))) {\n                self.uploadText(text);\n                self.clearPasteCatcher();\n                return;\n            }\n\n            // Loop through all the clipboardData\n            for (var x = 0; x < clipboardData.items.length; x++) {\n                // If this clipboard item claims to be an image, upload it\n                if (clipboardData.items[x].type.indexOf('image') !== -1) {\n                    self.uploadBlob(clipboardData.items[x].getAsFile());\n                    done = true;\n                }\n            }\n        }\n\n        // If there was nothing found in the clipboard data\n        // fall back to checking if there's anything in the editable element\n        if (done) {\n            self.clearPasteCatcher();\n        } else {\n            setTimeout(\n                function () {\n                    self.checkPasteCatcher();\n                },\n                10\n            );\n        }\n    };\n\n    /**\n     * Check if anything has been pasted into the paste catcher element\n     * (Firefox + Safari?)\n     */\n    ImagePaster.prototype.checkPasteCatcher = function () {\n\n        var text = this.pasteCatcher.innerHTML;\n        var child = this.pasteCatcher.childNodes[0];\n\n        if (child) {\n            if (child.tagName === 'IMG') {\n                if (child.src.indexOf('webkit-fake-url://') != -1) {\n                    this.onFail('Sorry, Safari does not currently support pasting images.');\n                    return false;\n                }\n                this.uploadImage(child.src);\n            } else if (child.tagName === 'A') {\n                this.uploadText(child.href);\n            } else {\n                this.uploadText(text);\n            }\n        }\n\n        this.clearPasteCatcher();\n    };\n\n    ImagePaster.prototype.clearPasteCatcher = function () {\n        var self = this;\n        setTimeout(\n            function () {\n                self.pasteCatcher.innerHTML = '';\n            },\n            1\n        );\n    };\n\n    ImagePaster.prototype.uploadBlob = function (blob) {\n        if (blob) {\n            var self = this;\n            var reader = new FileReader();\n            reader.onload = function (evt) {\n                self.uploadImage(evt.target.result);\n            };\n            reader.readAsDataURL(blob);\n        }\n    };\n\n    ImagePaster.prototype.uploadText = function (text) {\n        console.log('uploadText', text);\n        return this.upload('text', text);\n\n        /*if (this.validateURL(url)) {\n         upload('url', url);\n         } else {\n         failedUpload(\"Can't upload that. Try pasting an image or URL.\");\n         }*/\n    };\n\n    ImagePaster.prototype.uploadImage = function (base64) {\n        return this.upload('uploadImage', base64);\n\n        /*convertImageToJpeg(base64, function(jpegBase64){\n         upload('base64', jpegBase64);\n         });*/\n    };\n\n    /*ImagePaster.prototype.convertImageToJpeg = function(base64, callback)\n     {\n     //Convert image to a JPG so it's faster to upload\n     var img = new Image();\n     img.onload = function()\n     {\n     var canvas = convertImageToCanvas(this);\n     var data = canvas.toDataURL('image/jpeg' , 0.8);\n     callback(data);\n     };\n     img.src = base64;\n     };*/\n\n    /*ImagePaster.prototype.convertImageToCanvas = function(image)\n     {\n     var canvas = document.createElement(\"canvas\");\n     canvas.width = image.width;\n     canvas.height = image.height;\n\n     var context = canvas.getContext(\"2d\");\n     context.fillStyle = \"#ffffff\";\n     context.fillRect(0,0,image.width,image.height);\n     context.drawImage(image, 0, 0);\n\n     return canvas;\n     };*/\n\n    ImagePaster.prototype.upload = function (format, data) {\n\n        var self = this;\n        $(document).trigger('ctrlvuploadstart');\n\n        var url = this.url;\n        if (typeof url === 'function') {\n            url = url();\n        }\n\n        $.ajax({\n            url: url,\n            timeout: 90000,\n            type: 'POST',\n            data: {\n                format: format,\n                base64: data\n            },\n            error: function (jqXHR, textStatus) {\n                // Turn this error message into something useful\n                var message;\n                switch (textStatus) {\n                    case 'timeout':\n                        message = 'The image took too long to upload';\n                        break;\n                    case 'error':\n\n                        if (jqXHR.responseJSON && jqXHR.responseJSON.message) {\n                            message = 'CtrlV server error (' + jqXHR.responseJSON.errorType + ' ' + jqXHR.responseJSON.message + ')';\n                        } else if (jqXHR.status !== 0) {\n                            message = 'CtrlV server error (' + jqXHR.status + ' ' + jqXHR.statusText + ')';\n                        } else {\n                            message = 'Can\\'t connect to the CtrlV server';\n                        }\n                        break;\n                    case 'abort':\n                        message = 'The upload was cancelled';\n                        break;\n                    case 'parsererror':\n                        message = 'Error uploading: couldn\\'t decode the response from the server';\n                        break;\n                    default:\n                        message = textStatus;\n                        break;\n                }\n\n                self.onFail(message);\n            },\n            success: function (res) {\n                if (res.image) {\n                    $(document).trigger({\n                        type: 'ctrlvuploadcomplete',\n                        image: res.image\n                    });\n                } else {\n                    self.onFail(res.message);\n                }\n            }\n        });\n    };\n\n    ImagePaster.prototype.onFail = function (message) {\n        $(document).trigger({\n            type: 'ctrlvuploaderror',\n            message: message ? message : false\n        });\n    };\n\n    ImagePaster.prototype.validateURL = function (text) {\n        var regex = new RegExp(\"^(http|https|ftp)\\://([a-zA-Z0-9\\.\\-]+(\\:[a-zA-Z0-9\\.&amp;%\\$\\-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\\-]+\\.)*[a-zA-Z0-9\\-]+\\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(\\:[0-9]+)*(/($|[a-zA-Z0-9\\.\\,\\?\\'\\\\\\+&amp;%\\$#\\=~_\\-]+))*$\");\n        return regex.test(text);\n    };\n\n    return ImagePaster;\n}());\n","app.factory(\n    'AlbumResource',\n    function ($resource, AuthService) {\n        return $resource(\n            apiUrl + 'albums/:albumId',\n            {\n                albumId: '@albumId',\n                sessionKey: function() {\n                    return AuthService.getSessionKey() || null;\n                }\n            },\n            {\n                get: {\n                    cache: true,\n                    transformResponse: function(data) {\n                        data = angular.fromJson(data);\n                        return data.image;\n                    }\n                },\n\n                getImages: {\n                    cache: true,\n                    url: apiUrl + 'albums/:albumId/images',\n                    isArray: true,\n                    transformResponse: function(data) {\n                        var data = angular.fromJson(data);\n                        return data.images;\n                    }\n                }\n\n            }\n        );\n    }\n);\n","app.factory(\n    'ImageResource',\n    function ($resource, AuthService) {\n        return $resource(\n            apiUrl + 'images/:imageId',\n            {\n                imageId: '@imageId',\n                sessionKey: function() {\n                    return AuthService.getSessionKey() || null;\n                }\n            },\n            {\n                get: {\n                    cache: true,\n                },\n\n                revert: {\n                    url: apiUrl + 'images/:imageId/image',\n                    method: 'PUT',\n                    params: {\n                        action: 'revert'\n                    }\n                },\n\n                rotate: {\n                    url: apiUrl + 'images/:imageId/image',\n                    method: 'PUT',\n                    params: {\n                        action: 'rotate',\n                        degrees: 90\n                    }\n                },\n\n                crop: {\n                    url: apiUrl + 'images/:imageId/crop',\n                    method: 'POST'\n                }\n            }\n        );\n    }\n);\n","app.factory(\n    'SessionResource',\n    function ($resource) {\n        return $resource(\n            apiUrl + 'sessions/:sessionKey',\n            {},\n            {\n                get: {\n                    transformResponse: function(data) {\n                        data = angular.fromJson(data);\n                        return data.session;\n                    }\n                }\n            }\n        );\n    }\n);\n","app.factory(\n    'UserResource',\n    function ($resource, AuthService) {\n        return $resource(\n            apiUrl + 'users/:username',\n            {\n                username: '@username',\n                sessionKey: function() {\n                    return AuthService.getSessionKey() || null;\n                }\n            },\n            {\n                get: {\n                    cache: true,\n                    transformResponse: function(data) {\n                        var data = angular.fromJson(data);\n                        return data.user;\n                    }\n                },\n\n                save: {\n                    method: 'POST',\n                    url: apiUrl + 'users'\n                },\n\n                getImages: {\n                    cache: true,\n                    url: apiUrl + 'users/:username/images?page=:page',\n                    /*isArray: true,\n                    transformResponse: function(data) {\n                        var data = angular.fromJson(data);\n                        return data.images;\n                    }*/\n                },\n\n                getAlbums: {\n                    cache: true,\n                    url: apiUrl + 'users/:username/albums',\n                    /*isArray: true,\n                    transformResponse: function(data) {\n                        var data = angular.fromJson(data);\n                        return data;\n                    }*/\n                }\n            }\n        );\n    }\n);\n","app.service(\n    'AuthService',\n    function (localStorageService, SessionResource, $q, $rootScope) {\n\n        var session = null;\n        var sessionKey = null;\n\n        return {\n\n            checkSession: function() {\n                var self = this;\n\n                if (sessionKey = localStorageService.get('sessionKey')) {\n                    SessionResource.get(\n                        {sessionKey: sessionKey},\n                        function (session) {\n                            self.onLogin(session, sessionKey);\n                        },\n                        function() {\n                            self.onLogout();\n                        }\n                    );\n                } else {\n                    self.onLogout();\n                }\n            },\n\n            /**\n             * @param username\n             * @param password\n             * @returns $q\n             */\n            login: function(username, password) {\n                var self = this;\n\n                return $q(function(resolve, reject) {\n\n                    SessionResource.save({\n                        username: username,\n                        password: password\n                    }, function(response) {\n\n                        self.onLogin(response.session, response.sessionKey);\n\n                        // Resolve promise (sends back user)\n                        resolve(response.session.user);\n\n                    }, function (response) {\n                        reject(response.data);\n                    });\n\n                });\n            },\n\n            onLogin: function(newSession, newSessionKey) {\n\n                session = newSession;\n                sessionKey = newSessionKey;\n                localStorageService.set('sessionKey', newSessionKey);\n\n                // Tell everybody we're logged in\n                $rootScope.$broadcast('login', {user: newSession.user});\n\n            },\n\n            logout: function() {\n                var self = this;\n\n                SessionResource.delete({\n                    sessionKey: sessionKey\n                });\n\n                self.onLogout();\n\n            },\n\n            onLogout: function() {\n\n                session = false;\n                sessionKey = false;\n                localStorageService.remove('sessionKey');\n\n                // Tell everybody we're logged in\n                $rootScope.$broadcast('logout');\n\n            },\n\n            getSessionKey: function() {\n                return sessionKey;\n            },\n\n            getUser: function() {\n                if (session === null) {\n                    return null;\n                }\n\n                return session && session.user ? session.user : false;\n            }\n        };\n    }\n);\n","app.service(\n    'ImagePasterService',\n    function($state, AuthService) {\n\n        /**\n         * Add listeners for events that ImagePaster broadcasts.\n         */\n        $(document).on('ctrlvuploadstart', function () {\n            $('.upload-status').addClass('out');\n            $('#upload-loading').removeClass('out');\n        });\n\n        $(document).on('ctrlvuploadcomplete', function (e) {\n            $('.upload-status').addClass('out');\n            $('#upload-complete').removeClass('out');\n            var viewUrl = e.image.url;\n            var imageUrl = e.image.image.url;\n            $('#view-btn').attr('href', viewUrl);\n            $('#uploader').css('background-image', 'url(' + imageUrl + ')');\n\n            $state.go('image', {imageId: e.image.imageId});\n\n        });\n\n        $(document).on('ctrlvuploaderror', function (e) {\n            $('.upload-status').addClass('out');\n            $('#upload-error').removeClass('out').find('p').text(e.message);\n        });\n\n        $(document).on('keyup', function (e) {\n            // Highlighting keys when pressing\n            if (e.which == 91 || e.which === 224) { // cmd\n                $('.btn-cmd').removeClass('active');\n            } else if (e.which == 17) { // ctrl\n                $('.btn-ctrl').removeClass('active');\n            } else if (e.which == 86) { // v\n                $('.btn-v').removeClass('active');\n            }\n        });\n\n        $(document).on('keydown', function (e) {\n            // Highlighting keys when pressing\n            if (e.which == 91 || e.which === 224) { // cmd (91 in\n                $('.btn-cmd').addClass('active');\n            } else if (e.which == 17) { // ctrl\n                $('.btn-ctrl').addClass('active');\n            } else if (e.which == 86) { // v\n                $('.btn-v').addClass('active');\n            }\n        });\n\n        var getImageUploadUrl = function() {\n            var url = apiUrl + 'images';\n\n            var sessionKey;\n            if (sessionKey = AuthService.getSessionKey()) {\n                url += '?sessionKey=' + sessionKey;\n            }\n            return url;\n        };\n\n        return new ImagePaster(getImageUploadUrl);\n    }\n);\n"]}